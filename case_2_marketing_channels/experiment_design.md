# Experiment Design — Email vs Push Marketing Channels

## 1. Контекст и постановка задачи

Команда маркетинга использует несколько каналов коммуникации с пользователями,
включая email-рассылки и push-уведомления, для привлечения новых клиентов.

На основании рыночных бенчмарков бизнес предполагает, что push-уведомления
являются более эффективным каналом по сравнению с email.

Цель эксперимента — определить, какой канал коммуникации обеспечивает
наибольший чистый uplift в привлечении новых клиентов
при допустимом уровне побочных эффектов.

---

## 2. Гипотезы

### Нулевая гипотеза (H₀)
Email и push-коммуникации дают одинаковый эффект
на конверсию пользователей в новых клиентов.

### Альтернативная гипотеза (H₁)
Один из каналов коммуникации (email, push или их комбинация)
даёт больший uplift в конверсии пользователей в новых клиентов.

Тип гипотезы: двусторонняя  
Уровень значимости: α = 0.05

---

## 3. Тип эксперимента и варианты

### Тип эксперимента
A/B/n эксперимент с контрольной группой (4-arm test).

### Варианты
- **A — Control**  
  Пользователи не получают данную промо-коммуникацию.

- **B — Email**  
  Пользователи получают промо только по email.

- **C — Push**  
  Пользователи получают промо только через push-уведомление.

- **D — Email + Push**  
  Пользователи получают согласованную коммуникацию по обоим каналам.

Контрольная группа необходима для измерения
абсолютного uplift относительно отсутствия промо.

---

## 4. Выборка и eligibility

### Критерии включения
- пользователи, потенциально релевантные для промо;
- наличие opt-in для соответствующего канала коммуникации;
- отсутствие активных ограничений на получение сообщений.

### Критерии исключения
- пользователи без согласия на коммуникации;
- пользователи с частыми жалобами или отписками;
- тестовые и внутренние аккаунты.

Важно: пользователи без opt-in не должны искусственно
ухудшать метрики соответствующих групп.

---

## 5. Unit, рандомизация и сплит

### Unit of randomization
`user_id`.

### Механика назначения
Детерминированное назначение:
- hash(user_id + salt) → variant
- salt фиксирован на весь эксперимент;
- assignment стабилен между сессиями и платформами.

### Сплит
- A / B / C / D: 25% / 25% / 25% / 25%
(при необходимости допускается неравномерный сплит).

---

## 6. Контроль частоты, тайминга и креатива

Чтобы изолировать эффект канала, а не контента:

- одинаковый оффер во всех вариантах;
- одинаковая частота коммуникаций;
- синхронизированный тайминг отправок;
- единая логика ремайндеров.

Любые различия в креативах должны тестироваться
отдельными экспериментами после выбора канала.

---

## 7. Метрики

### 7.1 Primary-метрика
Конверсия в нового клиента
в течение 14 дней после получения коммуникации.

- Unit of analysis: user_id
- Тип: бинарная
- Анализ: ITT, Z-test или bootstrap CI

---

### 7.2 Guardrail-метрики
Используются для контроля негативных побочных эффектов:

- unsubscribe / opt-out rate;
- жалобы на спам;
- uninstall rate;
- bounce / delivery error rate.

Заранее определяются допустимые пороги деградации.

---

### 7.3 Informative-метрики
Используются для интерпретации результата:

- email open rate;
- email CTR;
- push impressions;
- push CTR;
- time-to-conversion;
- ARPU от новых клиентов.

---

## 8. Аналитический подход

- Основной анализ проводится по **Intention-to-Treat (ITT)**.
- Дополнительно проводится **per-protocol анализ**
  для пользователей, реально получивших коммуникацию.
- При существенном дисбалансе применяется стратификация
  или CUPED с историческими ковариатами.

---

## 9. Вызревание метрик

- Основной эффект коммуникаций проявляется в первые 3–14 дней.
- Дальнейшие изменения носят вторичный характер.

Выводы по primary-метрике делаются после стабилизации кривых конверсии.

---

## 10. Длительность эксперимента

- Минимальная длительность: 2 недели;
- Рекомендуемая: 4–6 недель;
- Продление возможно при малом ожидаемом эффекте.

---

## 11. Риски и ограничения

- Неравномерный opt-in между каналами;
- Каннибализация эффектов между email и push;
- Разная доставляемость сообщений;
- Поведенческая усталость от коммуникаций.

Для снижения рисков:
- контроль частоты;
- ITT-анализ;
- наличие kill-switch для оперативной остановки.

---

## 12. Критерии принятия решения

- Канал с максимальным uplift и допустимыми guardrail-метриками
  признаётся предпочтительным.
- Каналы с негативным влиянием на churn или отписки
  не масштабируются независимо от конверсии.

---

## 13. Следующие шаги

- A/B-тест креативов внутри победившего канала;
- тест тайминга и частоты;
- персонализация коммуникаций по сегментам;
- анализ LTV привлечённых пользователей.
